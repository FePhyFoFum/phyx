RM := rm -f

CONSEQ_SRC = main_conseq.cpp
CONSEQ_OBJ = main_conseq.o
CONSEQ_DEP = main_conseq.d

STREC_SRC = main_strec.cpp
STREC_OBJ = main_strec.o
STREC_DEP = main_strec.d

MRCA_SRC = main_mrca.cpp
MRCA_OBJ = main_mrca.o
MRCA_DEP = main_mrca.d

MRCACUT_SRC = main_mrca_cut.cpp
MRCACUT_OBJ = main_mrca_cut.o
MRCACUT_DEP = main_mrca_cut.d

MRCANAME_SRC = main_mrca_name.cpp
MRCANAME_OBJ = main_mrca_name.o
MRCANAME_DEP = main_mrca_name.d

BD_SRC = main_bd.cpp
BD_OBJ = main_bd.o
BD_DEP = main_bd.d

NNI_SRC = main_nni.cpp
NNI_OBJ = main_nni.o
NNI_DEP = main_nni.d

SEQT_SRC = main_seq_test.cpp
SEQT_OBJ = main_seq_test.o
SEQT_DEP = main_seq_test.d

TOFA_SRC = main_stofa.cpp
TOFA_OBJ = main_stofa.o
TOFA_DEP = main_stofa.d

TOPHY_SRC = main_stophy.cpp
TOPHY_OBJ = main_stophy.o
TOPHY_DEP = main_stophy.d

TONEX_SRC = main_stonex.cpp
TONEX_OBJ = main_stonex.o
TONEX_DEP = main_stonex.d

FQFILT_SRC = main_fqfilt.cpp
FQFILT_OBJ = main_fqfilt.o
FQFILT_DEP = main_fqfilt.d

REVCOMP_SRC = main_revcomp.cpp
REVCOMP_OBJ = main_revcomp.o
REVCOMP_DEP = main_revcomp.d

NW_SRC = main_nw.cpp
NW_OBJ = main_nw.o
NW_DEP = main_nw.d

SEQSAMP_SRC = main_boot.cpp
SEQSAMP_OBJ = main_boot.o
SEQSAMP_DEP = main_boot.d

CPP_SRCS += \
./utils.cpp \
./node.cpp \
./tree.cpp \
./tree_reader.cpp \
./tree_utils.cpp \
./sequence.cpp \
./seq_reader.cpp \
./seq_utils.cpp \
./seq_models.cpp \
./pairwise_alignment.cpp \
./rate_model.cpp \
./state_reconstructor.cpp \
./optimize_state_reconstructor_nlopt.cpp \
./bd_sim.cpp \
./superdouble.cpp \
./boot.cpp

CPP_OBJS += \
./utils.o \
./node.o \
./tree.o \
./tree_reader.o \
./tree_utils.o \
./sequence.o \
./seq_reader.o \
./seq_utils.o \
./seq_models.o \
./pairwise_alignment.o \
./rate_model.o \
./state_reconstructor.o \
./optimize_state_reconstructor_nlopt.o \
./bd_sim.o \
./superdouble.o \
./boot.o


CPP_DEPS += \
./utils.d \
./node.d \
./tree.d \
./tree_reader.d \
./tree_utils.d \
./sequence.d \
./seq_reader.d \
./seq_utils.d \
./seq_models.d \
./pairwise_alignment.d \
./rate_model.d \
./state_reconstructor.d \
./optimize_state_reconstructor_nlopt.d \
./bd_sim.d \
./superdouble.d \
./boot.d


CPP_LIBS = -llapack -lblas -lgfortran -lpthread -lm -lnlopt_cxx -larmadillo
#gsl
#-lgsl -lgslcblas 
#profileing
#-pg

OPT_FLAGS = -O3 -ffast-math -ftree-vectorize -fopenmp -g
#profiling 
#-g -pg
#-O3 -ffast-math -ftree-vectorize 

# Each subdirectory must supply rules for building sources it contributes
%.o: ./%.cpp
	g++ $(OPT_FLAGS) -c -fmessage-length=0 -MMD -MP -MF"$(@:%.o=%.d)" -MT"$(@:%.o=%.d)" -o  "$@" "$<"

# All Target
all: pxstrec pxmrca pxmrcacut pxmrcaname pxconseq pxbd pxnni pxseqtest pxstofa pxstophy pxstonex pxfqfilt pxrevcomp pxnw pxboot

pxstrec: $(CPP_OBJS) $(STREC_OBJ)
	@echo 'building pxstrec'
	g++ -o "pxstrec" $(OPT_FLAGS) $(STREC_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxmrca: $(CPP_OBJS) $(MRCA_OBJ)
	@echo 'building pxmrca'
	g++ -o "pxmrca" $(OPT_FLAGS) $(MRCA_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxmrcacut: $(CPP_OBJS) $(MRCACUT_OBJ) 
	@echo 'building pxmrcacut'
	g++ -o "pxmrcacut" $(OPT_FLAGS) $(MRCACUT_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxmrcaname: $(CPP_OBJS) $(MRCANAME_OBJ) 
	@echo 'building pxmrcaname'
	g++ -o "pxmrcaname" $(OPT_FLAGS) $(MRCANAME_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxconseq:  $(CPP_OBJS) $(CONSEQ_OBJ) 
	@echo 'building pxconseq'
	g++ -o "pxconseq" $(OPT_FLAGS) $(CONSEQ_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxbd:  $(CPP_OBJS) $(BD_OBJ) 
	@echo 'building pxbd'
	g++ -o "pxbd" $(OPT_FLAGS) $(BD_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxnni:  $(CPP_OBJS) $(NNI_OBJ) 
	@echo 'building pxnni'
	g++ -o "pxnni" $(OPT_FLAGS) $(NNI_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxseqtest:  $(CPP_OBJS) $(SEQT_OBJ) 
	@echo 'building pxseqtest'
	g++ -o "pxseqtest" $(OPT_FLAGS) $(SEQT_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxstofa:  $(CPP_OBJS) $(TOFA_OBJ) 
	@echo 'building pxstofa'
	g++ -o "pxstofa" $(OPT_FLAGS) $(TOFA_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxstophy:  $(CPP_OBJS) $(TOPHY_OBJ) 
	@echo 'building pxstophy'
	g++ -o "pxstophy" $(OPT_FLAGS) $(TOPHY_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxstonex:  $(CPP_OBJS) $(TONEX_OBJ) 
	@echo 'building pxstonex'
	g++ -o "pxstonex" $(OPT_FLAGS) $(TONEX_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxfqfilt:  $(CPP_OBJS) $(FQFILT_OBJ) 
	@echo 'building pxfqfilt'
	g++ -o "pxfqfilt" $(OPT_FLAGS) $(FQFILT_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxrevcomp:  $(CPP_OBJS) $(REVCOMP_OBJ) 
	@echo 'building pxrevcomp'
	g++ -o "pxrevcomp" $(OPT_FLAGS) $(REVCOMP_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxnw:  $(CPP_OBJS) $(NW_OBJ) 
	@echo 'building pxnw'
	g++ -o "pxnw" $(OPT_FLAGS) $(NW_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

pxboot:  $(CPP_OBJS) $(SEQSAMP_OBJ) 
	@echo 'building pxboot'
	g++ -o "pxboot" $(OPT_FLAGS) $(SEQSAMP_OBJ) $(CPP_OBJS) $(CPP_LIBS) 

# Other Targets
clean:
	-$(RM) *.o *.d px* 

